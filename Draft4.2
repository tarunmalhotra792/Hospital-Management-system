#from HMS_Draft1 import *


import re
def is_valid_email():
    global M
    M=0
    while M==0:
        email = raw_input ("Please type in an email address ")
        if re.match("\A(?P<name>[\w\-_]+)@(?P<domain>[\w\-_]+).(?P<toplevel>[\w]+)\Z",email,re.IGNORECASE):
            print("Email is valid")
            M+=1
            
            return M
            
        else :
            print("Email is invalid,Please try again")
            M=0
            is_valid_email()
            return M
            

def ExcelFileCreation():
    #Using xlwt modulde
    import xlwt
    from xlwt import Workbook

    wb=Workbook()

    sheet1=wb.add_sheet('PatientsDetails')

    sheet1.write(0,0,'First Name')
    sheet1.write(0,1,'Last Name')
    sheet1.write(0,2,'MobileNumber')
    sheet1.write(0,3,'Email Address')
    sheet1.write(0,4,'Home Address')


    wb.save('C:\Python27\Hospital_Management_System\Filed\PatientsDetails_2.xls')

    #Using openpyxl module
   
def writeintoexcel2():
    import xlrd
    from openpyxl import load_workbook
    import time
    workbook_name = r'C:\Python27\Hospital_Management_System\Filed\PatientsDetails_2.xls'
    wb = load_workbook(workbook_name)
    page = wb.active

    
    
    now = time.strftime("%x")
    page.append(Fname,Ename,Mnum,Address,now)
    wb.save(filename=workbook_name)


def GetUserDetails():

    print ("Please go ahead and register with  us with your personal details")
    
    Fname=raw_input("Please enter your First Name\n")
    Ename=raw_input("Please enter your Last Name\n")
    Mnum=input("Please enter your contact number\n")
    #Email=raw_input("Please enter your Email Address \n".format(Fname))
    is_valid_email()
    Address=raw_input("Please enter your home Address \n".format(Fname))
    writeintoexcel2()
    
def main():
    GetUserDetails()


main()
